{% extends 'base.html' %}
{% block title %}Seller Dashboard{% endblock %}

{% block content %}
<h2>Seller Dashboard</h2>

<!-- Total Earnings -->
<h5 class="mt-4">Total Earnings: ${{ earnings|default:"0" }}</h5>

<!-- Your Services -->
<h4 class="mt-4">Your Services</h4>
<table class="table table-striped">
  <thead>
    <tr>
      <th>Title</th>
      <th>Price</th>
      <th>Orders</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for service in services %}
    <tr>
      <td>{{ service.title }}</td>
      <td>${{ service.price }}</td>
      <td>{{ service.orders.count }}</td>
      <td>
        <a href="{% url 'service_update' service.id %}" class="btn btn-sm btn-warning">Edit</a>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4" class="text-center">No services posted yet.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Orders -->
<h4 class="mt-5">Orders</h4>
<table class="table table-striped">
  <thead>
    <tr>
      <th>Service</th>
      <th>Buyer</th>
      <th>Status</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for order in orders %}
    <tr>
      <td>{{ order.service.title }}</td>
      <td>{{ order.buyer.username }}</td>
      <td>
        {% if order.status == "completed" %}
          <span class="badge bg-success">Completed</span>
        {% elif order.status == "in_progress" %}
          <span class="badge bg-info">In Progress</span>
        {% else %}
          <span class="badge bg-secondary">Pending</span>
        {% endif %}
      </td>
      <td>
        <a href="{% url 'order_detail' order.id %}" class="btn btn-sm btn-primary">View</a>
        {% if order.status == "pending" %}
          <a href="{% url 'order_mark_inprogress' order.id %}" class="btn btn-sm btn-warning">Mark In Progress</a>
        {% elif order.status == "in_progress" %}
          <a href="{% url 'complete_order' order.id %}" class="btn btn-sm btn-success">Mark Completed</a>
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="4" class="text-center">No orders found.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
